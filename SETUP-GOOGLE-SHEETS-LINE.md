# ğŸ”§ à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Google Sheets + Line Notification Workflow

à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸™à¸µà¹‰à¸ˆà¸°à¹à¸™à¸°à¸™à¸³à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² workflow à¸ªà¸³à¸«à¸£à¸±à¸šà¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Google Sheets à¸à¸±à¸š Line Notification

## ğŸ“‹ à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹€à¸•à¸£à¸µà¸¢à¸¡

1. Google Account
2. Line Account
3. Google Sheets à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸²à¸¡
4. n8n instance à¸—à¸µà¹ˆà¸£à¸±à¸™à¸­à¸¢à¸¹à¹ˆ

## ğŸ”‘ à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Google Sheets API

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 1: à¸ªà¸£à¹‰à¸²à¸‡ Google Cloud Project

1. à¹„à¸›à¸—à¸µà¹ˆ [Google Cloud Console](https://console.cloud.google.com/)
2. à¸ªà¸£à¹‰à¸²à¸‡ Project à¹ƒà¸«à¸¡à¹ˆà¸«à¸£à¸·à¸­à¹€à¸¥à¸·à¸­à¸ Project à¸—à¸µà¹ˆà¸¡à¸µà¸­à¸¢à¸¹à¹ˆ
3. à¹€à¸›à¸´à¸”à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ Google Sheets API:
   - à¹„à¸›à¸—à¸µà¹ˆ "APIs & Services" > "Library"
   - à¸„à¹‰à¸™à¸«à¸² "Google Sheets API"
   - à¸„à¸¥à¸´à¸ "Enable"

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 2: à¸ªà¸£à¹‰à¸²à¸‡ Service Account

1. à¹„à¸›à¸—à¸µà¹ˆ "APIs & Services" > "Credentials"
2. à¸„à¸¥à¸´à¸ "Create Credentials" > "Service Account"
3. à¹ƒà¸ªà¹ˆà¸Šà¸·à¹ˆà¸­ Service Account (à¹€à¸Šà¹ˆà¸™ "n8n-sheets-integration")
4. à¸„à¸¥à¸´à¸ "Create and Continue"
5. à¹€à¸¥à¸·à¸­à¸ Role: "Editor" à¸«à¸£à¸·à¸­ "Viewer" (à¸•à¸²à¸¡à¸„à¸§à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸à¸²à¸£)
6. à¸„à¸¥à¸´à¸ "Done"

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 3: à¸ªà¸£à¹‰à¸²à¸‡ JSON Key

1. à¸„à¸¥à¸´à¸à¸—à¸µà¹ˆ Service Account à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸‚à¸¶à¹‰à¸™
2. à¹„à¸›à¸—à¸µà¹ˆà¹à¸—à¹‡à¸š "Keys"
3. à¸„à¸¥à¸´à¸ "Add Key" > "Create new key"
4. à¹€à¸¥à¸·à¸­à¸ "JSON" à¹à¸¥à¸°à¸„à¸¥à¸´à¸ "Create"
5. à¹„à¸Ÿà¸¥à¹Œ JSON à¸ˆà¸°à¸–à¸¹à¸à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸” - **à¹€à¸à¹‡à¸šà¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰à¹„à¸§à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢**

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 4: à¹à¸Šà¸£à¹Œ Google Sheets

1. à¹€à¸›à¸´à¸” Google Sheets à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™
2. à¸„à¸¥à¸´à¸ "Share" (à¹à¸Šà¸£à¹Œ)
3. à¹ƒà¸ªà¹ˆ email à¸‚à¸­à¸‡ Service Account (à¸ˆà¸²à¸ JSON file)
4. à¹ƒà¸«à¹‰à¸ªà¸´à¸—à¸˜à¸´à¹Œ "Editor" à¸«à¸£à¸·à¸­ "Viewer"
5. à¸„à¸¥à¸´à¸ "Send"

## ğŸ“± à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Line Notify

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 1: à¸ªà¸£à¹‰à¸²à¸‡ Line Notify Token

1. à¹„à¸›à¸—à¸µà¹ˆ [Line Notify](https://notify-bot.line.me/)
2. à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸”à¹‰à¸§à¸¢ Line Account
3. à¸„à¸¥à¸´à¸ "Generate token"
4. à¹ƒà¸ªà¹ˆà¸Šà¸·à¹ˆà¸­ Service (à¹€à¸Šà¹ˆà¸™ "n8n Google Sheets Alert")
5. à¹€à¸¥à¸·à¸­à¸à¸à¸¥à¸¸à¹ˆà¸¡à¸«à¸£à¸·à¸­à¹à¸Šà¸—à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸£à¸±à¸šà¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
6. à¸„à¸¥à¸´à¸ "Generate token"
7. **à¸„à¸±à¸”à¸¥à¸­à¸à¹à¸¥à¸°à¹€à¸à¹‡à¸š Token à¹„à¸§à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢**

## âš™ï¸ à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹ƒà¸™ n8n

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 1: Import Workflow

1. à¹€à¸‚à¹‰à¸²à¹„à¸›à¸—à¸µà¹ˆ n8n (http://localhost:5678)
2. à¸„à¸¥à¸´à¸ "Import from file"
3. à¹€à¸¥à¸·à¸­à¸à¹„à¸Ÿà¸¥à¹Œ `google-sheets-line-notification.json`
4. à¸„à¸¥à¸´à¸ "Import"

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 2: à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Google Sheets Credentials

1. à¸„à¸¥à¸´à¸à¸—à¸µà¹ˆ "Google Sheets" node
2. à¹ƒà¸™ "Credential for Google Sheets API" à¸„à¸¥à¸´à¸ "Create New"
3. à¹€à¸¥à¸·à¸­à¸ "Service Account"
4. à¸§à¸²à¸‡ JSON content à¸ˆà¸²à¸ Service Account key file
5. à¸„à¸¥à¸´à¸ "Save"

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 3: à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Google Sheets Document

1. à¹ƒà¸™ Google Sheets node
2. à¹à¸à¹‰à¹„à¸‚ "Document ID":
   - à¸„à¸±à¸”à¸¥à¸­à¸ ID à¸ˆà¸²à¸ URL à¸‚à¸­à¸‡ Google Sheets
   - URL: `https://docs.google.com/spreadsheets/d/[SHEET_ID]/edit`
   - à¹ƒà¸ªà¹ˆ SHEET_ID à¹ƒà¸™à¸Šà¹ˆà¸­à¸‡ "Document ID"
3. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² "Sheet Name" (à¹€à¸Šà¹ˆà¸™ "Sheet1")
4. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² "Range" (à¹€à¸Šà¹ˆà¸™ "A:Z" à¸ªà¸³à¸«à¸£à¸±à¸šà¸—à¸¸à¸ column)

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 4: à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Line Notify Credentials

1. à¸„à¸¥à¸´à¸à¸—à¸µà¹ˆ "Line Notify" node
2. à¹ƒà¸™ "Credential for Line Notify API" à¸„à¸¥à¸´à¸ "Create New"
3. à¹ƒà¸ªà¹ˆ Access Token à¸—à¸µà¹ˆà¹„à¸”à¹‰à¸ˆà¸²à¸ Line Notify
4. à¸„à¸¥à¸´à¸ "Save"

### à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 5: à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡ Schedule

1. à¸„à¸¥à¸´à¸à¸—à¸µà¹ˆ "Schedule Trigger" node
2. à¸›à¸£à¸±à¸š "Interval" à¸•à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸à¸²à¸£:
   - Minutes: à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸—à¸¸à¸à¸à¸µà¹ˆà¸™à¸²à¸—à¸µ
   - Hours: à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸—à¸¸à¸à¸à¸µà¹ˆà¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡
   - Days: à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸—à¸¸à¸à¸à¸µà¹ˆà¸§à¸±à¸™

## ğŸ§ª à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š Workflow

### à¸—à¸”à¸ªà¸­à¸šà¹à¸•à¹ˆà¸¥à¸° Node

1. **à¸—à¸”à¸ªà¸­à¸š Google Sheets**:
   - à¸„à¸¥à¸´à¸à¸—à¸µà¹ˆ Google Sheets node
   - à¸„à¸¥à¸´à¸ "Test step"
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸–à¸¹à¸à¸”à¸¶à¸‡à¸¡à¸²à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡

2. **à¸—à¸”à¸ªà¸­à¸š Line Notify**:
   - à¸„à¸¥à¸´à¸à¸—à¸µà¹ˆ Line Notify node
   - à¸„à¸¥à¸´à¸ "Test step"
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹„à¸”à¹‰à¸£à¸±à¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹ƒà¸™ Line

### à¸—à¸”à¸ªà¸­à¸š Workflow à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

1. à¸„à¸¥à¸´à¸ "Test workflow"
2. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¹ƒà¸™à¹à¸•à¹ˆà¸¥à¸° node
3. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹„à¸”à¹‰à¸£à¸±à¸šà¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹ƒà¸™ Line

## ğŸ”„ à¸à¸²à¸£à¹€à¸›à¸´à¸”à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ Workflow

1. à¸„à¸¥à¸´à¸à¸ªà¸§à¸´à¸•à¸Šà¹Œ "Active" à¸—à¸µà¹ˆà¸¡à¸¸à¸¡à¸‚à¸§à¸²à¸šà¸™
2. Workflow à¸ˆà¸°à¹€à¸£à¸´à¹ˆà¸¡à¸—à¸³à¸‡à¸²à¸™à¸•à¸²à¸¡ Schedule à¸—à¸µà¹ˆà¸•à¸±à¹‰à¸‡à¹„à¸§à¹‰
3. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Execution History à¹€à¸à¸·à¹ˆà¸­à¸”à¸¹à¸œà¸¥à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™

## ğŸ“Š à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™

### Use Case 1: à¸•à¸´à¸”à¸•à¸²à¸¡à¸¢à¸­à¸”à¸‚à¸²à¸¢
- Google Sheets: à¸šà¸±à¸™à¸—à¸¶à¸à¸¢à¸­à¸”à¸‚à¸²à¸¢à¸£à¸²à¸¢à¸§à¸±à¸™
- Line Notification: à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸¢à¸­à¸”à¸‚à¸²à¸¢à¹ƒà¸«à¸¡à¹ˆ

### Use Case 2: à¸•à¸´à¸”à¸•à¸²à¸¡à¸ªà¸–à¸²à¸™à¸°à¹‚à¸›à¸£à¹€à¸ˆà¸„
- Google Sheets: à¸­à¸±à¸›à¹€à¸”à¸•à¸ªà¸–à¸²à¸™à¸°à¸‡à¸²à¸™
- Line Notification: à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¸ªà¸–à¸²à¸™à¸°

### Use Case 3: à¸•à¸´à¸”à¸•à¸²à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¥à¸¹à¸à¸„à¹‰à¸²
- Google Sheets: à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¥à¸¹à¸à¸„à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ
- Line Notification: à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸¥à¸¹à¸à¸„à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ

## ğŸ› ï¸ à¸à¸²à¸£à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡

### à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ Line Notification

à¹à¸à¹‰à¹„à¸‚à¹ƒà¸™ "Process Sheet Data" node (Code node):

```javascript
// à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¸£à¸¹à¸›à¹à¸šà¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡
let message = 'ğŸ”” **à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸ˆà¸²à¸ Google Sheets**\n\n';

// à¹€à¸à¸´à¹ˆà¸¡à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
if (latestRow.status === 'urgent') {
  message = 'ğŸš¨ **à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸”à¹ˆà¸§à¸™!**\n\n';
}

// à¹€à¸à¸´à¹ˆà¸¡ emoji à¸•à¸²à¸¡à¸›à¸£à¸°à¹€à¸ à¸—à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
if (latestRow.type === 'sale') {
  message += 'ğŸ’° ';
} else if (latestRow.type === 'task') {
  message += 'ğŸ“‹ ';
}
```

### à¹€à¸à¸´à¹ˆà¸¡à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™

à¹à¸à¹‰à¹„à¸‚à¹ƒà¸™ "Check Data Exists" node:

```javascript
// à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸‰à¸à¸²à¸°à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸¡à¸µ priority à¸ªà¸¹à¸‡
$json.priority === 'high'

// à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸‰à¸à¸²à¸°à¹ƒà¸™à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¸—à¸³à¸à¸²à¸£
new Date().getHours() >= 9 && new Date().getHours() <= 17
```

## â— à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚à¸›à¸±à¸à¸«à¸²

### à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸à¸šà¸šà¹ˆà¸­à¸¢

1. **Google Sheets à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹„à¸”à¹‰**
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹à¸Šà¸£à¹Œ Sheets à¹ƒà¸«à¹‰ Service Account à¹à¸¥à¹‰à¸§
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š JSON credentials à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹€à¸›à¸´à¸”à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ Google Sheets API à¹à¸¥à¹‰à¸§

2. **Line Notify à¹„à¸¡à¹ˆà¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡**
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Access Token à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² Token à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ internet

3. **Workflow à¹„à¸¡à¹ˆà¸—à¸³à¸‡à¸²à¸™à¸•à¸²à¸¡ Schedule**
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² Workflow à¹€à¸›à¹‡à¸™ "Active"
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Schedule Trigger settings
   - à¸”à¸¹ Execution History à¹€à¸à¸·à¹ˆà¸­à¸«à¸²à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”

### à¸à¸²à¸£ Debug

1. à¸”à¸¹ Execution logs à¹ƒà¸™ n8n
2. à¸—à¸”à¸ªà¸­à¸šà¹à¸•à¹ˆà¸¥à¸° node à¹à¸¢à¸à¸à¸±à¸™
3. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Error messages
4. à¹ƒà¸Šà¹‰ "Sticky Note" node à¹€à¸à¸·à¹ˆà¸­ debug à¸‚à¹‰à¸­à¸¡à¸¹à¸¥

## ğŸ”’ à¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢

- à¹€à¸à¹‡à¸š Service Account JSON file à¸­à¸¢à¹ˆà¸²à¸‡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢
- à¹„à¸¡à¹ˆà¹à¸Šà¸£à¹Œ Line Notify Token à¸à¸±à¸šà¸œà¸¹à¹‰à¸­à¸·à¹ˆà¸™
- à¹ƒà¸Šà¹‰à¸ªà¸´à¸—à¸˜à¸´à¹Œà¸‚à¸±à¹‰à¸™à¸•à¹ˆà¸³à¸—à¸µà¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™à¸ªà¸³à¸«à¸£à¸±à¸š Google Sheets
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Execution logs à¹€à¸›à¹‡à¸™à¸›à¸£à¸°à¸ˆà¸³

---

**ğŸ‰ à¸‚à¸­à¹ƒà¸«à¹‰à¸ªà¸™à¸¸à¸à¸à¸±à¸šà¸à¸²à¸£ Automate!**