{
  "name": "Google Sheets to Telegram Bot",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 5
            }
          ]
        }
      },
      "id": "a1b2c3d4-1111-2222-3333-444455556666",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        720,
        300
      ]
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "resource": "sheet",
        "operation": "read",
        "documentId": {
          "__rl": true,
          "value": "YOUR_GOOGLE_SHEET_ID",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Sheet1",
          "mode": "name"
        },
        "range": "A:Z",
        "options": {
          "valueRenderMode": "FORMATTED_VALUE"
        }
      },
      "id": "b2c3d4e5-2222-3333-4444-555566667777",
      "name": "Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        940,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "c3d4e5f6-3333-4444-5555-666677778888",
              "leftValue": "={{ $json.length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "d4e5f6g7-4444-5555-6666-777788889999",
      "name": "Check Data Exists",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        1160,
        300
      ]
    },
    {
      "parameters": {
        "jsCode": "// ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Telegram Bot\nconst data = $input.all();\nconst rows = data[0].json;\n\nif (!rows || rows.length === 0) {\n  return [];\n}\n\n// ‡∏´‡∏≤‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\nconst latestRow = rows[rows.length - 1];\n\n// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Telegram (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Markdown)\nlet message = '*üìä ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å Google Sheets*\\n\\n';\n\n// ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏ú‡πà‡∏≤‡∏ô columns ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\nObject.keys(latestRow).forEach(key => {\n  if (latestRow[key] && latestRow[key].toString().trim() !== '') {\n    message += `*${key}:* ${latestRow[key]}\\n`;\n  }\n});\n\nmessage += `\\nüïê *‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï:* ${new Date().toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' })}`;\n\n// ‡∏™‡∏£‡πâ‡∏≤‡∏á Inline Keyboard ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Telegram\nconst inlineKeyboard = {\n  \"inline_keyboard\": [\n    [\n      {\n        \"text\": \"üìä ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\",\n        \"callback_data\": \"view_all_data\"\n      },\n      {\n        \"text\": \"üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä\",\n        \"callback_data\": \"refresh_data\"\n      }\n    ],\n    [\n      {\n        \"text\": \"üìù ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets\",\n        \"url\": \"https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID\"\n      }\n    ],\n    [\n      {\n        \"text\": \"üìà ‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü\",\n        \"callback_data\": \"view_chart\"\n      },\n      {\n        \"text\": \"üìã ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\",\n        \"callback_data\": \"export_data\"\n      }\n    ]\n  ]\n};\n\nreturn [{\n  json: {\n    message: message,\n    inlineKeyboard: inlineKeyboard,\n    totalRows: rows.length,\n    latestData: latestRow,\n    timestamp: new Date().toISOString(),\n    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö fallback ‡πÄ‡∏õ‡πá‡∏ô plain text\n    plainMessage: `üìä ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å Google Sheets\\n\\n${Object.keys(latestRow).map(key => latestRow[key] ? `${key}: ${latestRow[key]}` : '').filter(Boolean).join('\\n')}\\n\\nüïê ${new Date().toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' })}`\n  }\n}];"
      },
      "id": "e5f6g7h8-5555-6666-7777-888899990000",
      "name": "Process Sheet Data for Telegram",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1380,
        200
      ]
    },
    {
      "parameters": {
        "url": "=https://api.telegram.org/bot{{ $('Set Bot Token').item.json.botToken }}/sendMessage",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": []
        },
        "jsonBody": "={\n  \"chat_id\": \"{{ $('Set Bot Token').item.json.chatId }}\",\n  \"text\": \"{{ $json.message }}\",\n  \"parse_mode\": \"Markdown\",\n  \"reply_markup\": $json.inlineKeyboard\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "f6g7h8i9-6666-7777-8888-999900001111",
      "name": "Telegram Bot - Send Message",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1600,
        200
      ]
    },
    {
      "parameters": {
        "url": "=https://api.telegram.org/bot{{ $('Set Bot Token').item.json.botToken }}/sendMessage",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": []
        },
        "jsonBody": "={\n  \"chat_id\": \"{{ $('Set Bot Token').item.json.chatId }}\",\n  \"text\": \"‚ÑπÔ∏è *‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà*\\n\\n‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô Google Sheets ‡∏ì ‡πÄ‡∏ß‡∏•‡∏≤ \" + new Date().toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' }),\n  \"parse_mode\": \"Markdown\"\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "g7h8i9j0-7777-8888-9999-000011112222",
      "name": "Telegram Bot - No Data",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1600,
        400
      ]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "botToken",
              "value": "YOUR_TELEGRAM_BOT_TOKEN"
            },
            {
              "name": "chatId",
              "value": "YOUR_TELEGRAM_CHAT_ID"
            }
          ]
        },
        "options": {}
      },
      "id": "h8i9j0k1-8888-9999-0000-111122223333",
      "name": "Set Bot Token",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1200,
        100
      ]
    },
    {
      "parameters": {
        "content": "## ü§ñ Google Sheets to Telegram Bot Workflow\n\n### ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:\n1. **Schedule Trigger**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ\n2. **Google Sheets**: ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets\n3. **Check Data**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\n4. **Process Data**: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Markdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Telegram\n5. **Telegram Bot API**: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏° Inline Keyboard\n\n### ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥:\n- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö Markdown (Bold, Italic)\n- Inline Keyboard ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö\n- ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Chat/Channel ‡πÄ‡∏â‡∏û‡∏≤‡∏∞\n- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Callback Actions\n\n### ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:\n- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `YOUR_TELEGRAM_BOT_TOKEN`\n- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `YOUR_TELEGRAM_CHAT_ID`\n- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `YOUR_GOOGLE_SHEET_ID`\n- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Service Account",
        "height": 464,
        "width": 389
      },
      "id": "i9j0k1l2-9999-0000-1111-222233334444",
      "name": "Workflow Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        480,
        80
      ]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "status",
              "value": "no_data"
            },
            {
              "name": "message",
              "value": "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô Google Sheets"
            },
            {
              "name": "timestamp",
              "value": "={{ new Date().toISOString() }}"
            }
          ]
        },
        "options": {}
      },
      "id": "j0k1l2m3-0000-1111-2222-333344445555",
      "name": "No Data Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1380,
        400
      ]
    }
  ],
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "Check Data Exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Data Exists": {
      "main": [
        [
          {
            "node": "Set Bot Token",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Data Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Sheet Data for Telegram": {
      "main": [
        [
          {
            "node": "Telegram Bot - Send Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Bot Token": {
      "main": [
        [
          {
            "node": "Process Sheet Data for Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Data Response": {
      "main": [
        [
          {
            "node": "Telegram Bot - No Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "67890123-6789-6789-6789-678901234567",
  "id": "6",
  "meta": {
    "instanceId": "67890123456789012345678901234567"
  },
  "tags": [
    {
      "createdAt": "2024-01-15T10:00:00.000Z",
      "updatedAt": "2024-01-15T10:00:00.000Z",
      "id": "15",
      "name": "google-sheets"
    },
    {
      "createdAt": "2024-01-15T10:00:00.000Z",
      "updatedAt": "2024-01-15T10:00:00.000Z",
      "id": "16",
      "name": "telegram-bot"
    },
    {
      "createdAt": "2024-01-15T10:00:00.000Z",
      "updatedAt": "2024-01-15T10:00:00.000Z",
      "id": "17",
      "name": "automation"
    },
    {
      "createdAt": "2024-01-15T10:00:00.000Z",
      "updatedAt": "2024-01-15T10:00:00.000Z",
      "id": "18",
      "name": "inline-keyboard"
    }
  ]
}